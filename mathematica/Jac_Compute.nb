(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      7641,        206]
NotebookOptionsPosition[      7320,        191]
NotebookOutlinePosition[      7663,        206]
CellTagsIndexPosition[      7620,        203]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x1", "=", 
     RowBox[{"{", 
      RowBox[{"x1x", ",", "x1y", ",", "x1z"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"x2", "=", 
     RowBox[{"{", 
      RowBox[{"x2x", ",", "x2y", ",", "x2z"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"x3", "=", 
     RowBox[{"{", 
      RowBox[{"x3x", ",", "x3y", ",", "x3z"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"x4", "=", 
     RowBox[{"{", 
      RowBox[{"x4x", ",", "x4y", ",", "x4z"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r1", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x1", "-", "x3"}], ")"}], "/", " ", 
       SqrtBox[
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x1", "-", "x3"}], ")"}], "^", "2"}], "]"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x2", "-", "x4"}], ")"}], "/", " ", 
       SqrtBox[
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x2", "-", "x4"}], ")"}], "^", "2"}], "]"}]]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r1Unit", "=", " ", 
     RowBox[{"r1", "/", 
      RowBox[{"Norm", "[", "r1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r3", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1", "-", "x3"}], "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", "-", "x3"}], "}"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", "-", "x3"}], "}"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "0", ",", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1", "-", "x3"}], "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1", "-", "x3"}], "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", "-", "x3"}], "}"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "0"}], "}"}]}], "}"}],
       ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"x2", "-", "x4"}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r3Unit", "=", " ", 
     RowBox[{"r3", "/", 
      SqrtBox[
       RowBox[{"Total", "[", 
        RowBox[{"r3", "^", "2"}], "]"}]]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5600829544186306`*^9, 3.5600829720706406`*^9}, {
   3.5600832781398754`*^9, 3.5600833794656715`*^9}, {3.560083445870469*^9, 
   3.560083560700037*^9}, {3.5600837183850565`*^9, 3.5600837463026533`*^9}, {
   3.5600838733759212`*^9, 3.5600839069378405`*^9}, {3.560083995400901*^9, 
   3.5600841531339226`*^9}, {3.5600842593429976`*^9, 3.560084333420234*^9}, {
   3.560084582586486*^9, 3.560084700607236*^9}, {3.5600847490110044`*^9, 
   3.560084751829166*^9}, {3.5600849236709948`*^9, 3.5600849652773743`*^9}, {
   3.5600850148822117`*^9, 3.5600850959608493`*^9}, {3.5600851755264*^9, 
   3.5600851798926497`*^9}, 3.5600853160274363`*^9, {3.5600856144425044`*^9, 
   3.560085803622325*^9}, {3.5600875966481023`*^9, 3.560087597552904*^9}, {
   3.5600876711938696`*^9, 3.5600876715708914`*^9}, 3.560087728035121*^9, {
   3.560087785070383*^9, 3.560087803409432*^9}, {3.5600942022522116`*^9, 
   3.560094242220482*^9}, {3.560095151714899*^9, 3.5600951540705028`*^9}, {
   3.5600952528654766`*^9, 3.560095265922699*^9}, 3.5600957585692472`*^9, {
   3.560095838329*^9, 3.560095842743808*^9}, 3.560113142344632*^9, {
   3.560146379820857*^9, 3.560146424612419*^9}, {3.5601466155683413`*^9, 
   3.5601466160933714`*^9}, 3.56014673234702*^9, {3.5601467666259813`*^9, 
   3.5601468234212294`*^9}, {3.5601468981795053`*^9, 3.560146927089159*^9}, {
   3.560147022230601*^9, 3.5601470586226826`*^9}, {3.5601471278206406`*^9, 
   3.560147141663432*^9}, {3.56019357587462*^9, 3.560193577824623*^9}, {
   3.560193831027857*^9, 3.5601938490624886`*^9}, {3.5601939421790524`*^9, 
   3.56019398640513*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.560193949355065*^9, 3.5601939509150677`*^9}}],

Cell[BoxData[{
 RowBox[{"<<", "ToMatlab.m"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1Partial", "=", 
   RowBox[{"D", "[", 
    RowBox[{"r1Unit", ",", "x1y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"r1Partial", ",", 
     RowBox[{"{", 
      RowBox[{
      "r1Partial", ",", "x1x", ",", "x1y", ",", "x1z", ",", "x2x", ",", "x2y",
        ",", "x2z", ",", "x3x", ",", "x3y", ",", "x3z", ",", "x4x", ",", 
       "x4y", ",", "x4z"}], " ", "}"}], " ", ",", "Reals"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r3Unit", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1Partial", "=", 
   RowBox[{"D", "[", 
    RowBox[{"r3Unit", ",", "x1y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"r1Partial", ",", 
     RowBox[{"{", 
      RowBox[{
      "r1Partial", ",", "x1x", ",", "x1y", ",", "x1z", ",", "x2x", ",", "x2y",
        ",", "x2z", ",", "x3x", ",", "x3y", ",", "x3z", ",", "x4x", ",", 
       "x4y", ",", "x4z"}], " ", "}"}], " ", ",", "Reals"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.560113157944659*^9, 3.5601132069599457`*^9}, {
   3.560115508579898*^9, 3.5601155508715725`*^9}, {3.5601462659163423`*^9, 
   3.560146299042237*^9}, {3.5601464506789103`*^9, 3.560146491989273*^9}, 
   3.5601470916495714`*^9, {3.5601471792805834`*^9, 3.560147280427369*^9}, {
   3.560147360536951*^9, 3.560147392058754*^9}, {3.5601474787027097`*^9, 
   3.5601475034751263`*^9}, 3.560147535900981*^9, {3.560193593471451*^9, 
   3.5601936247057056`*^9}, 3.5601937372872925`*^9, {3.5601937732297554`*^9, 
   3.560193773604156*^9}, {3.5601938656609173`*^9, 3.5601938786869407`*^9}, {
   3.560193909091394*^9, 3.5601939631298885`*^9}, {3.5601939959211464`*^9, 
   3.5601939984795513`*^9}}]
},
WindowSize->{1264, 665},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 4685, 120, 205, "Input"],
Cell[5245, 142, 94, 1, 31, "Input"],
Cell[5342, 145, 1974, 44, 172, "Input"]
}
]
*)

(* End of internal cache information *)
