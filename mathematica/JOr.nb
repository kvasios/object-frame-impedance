(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     15474,        464]
NotebookOptionsPosition[     15030,        446]
NotebookOutlinePosition[     15373,        461]
CellTagsIndexPosition[     15330,        458]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"r1x", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x1x", "-", "x3x"}], ")"}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1x", "-", "x3x"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1y", "-", "x3y"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1z", "-", "x3z"}], ")"}], "^", "2"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x2x", "-", "x4x"}], ")"}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2x", "-", "x4x"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2y", "-", "x4y"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2z", "-", "x4z"}], ")"}], "^", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1y", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x1y", "-", "x3y"}], ")"}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1x", "-", "x3x"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1y", "-", "x3y"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x1z", "-", "x3z"}], ")"}], "^", "2"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x2y", "-", "x4y"}], ")"}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2x", "-", "x4x"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2y", "-", "x4y"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2z", "-", "x4z"}], ")"}], "^", "2"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r1z", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x1z", "-", "x3z"}], ")"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x1x", "-", "x3x"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x1y", "-", "x3y"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x1z", "-", "x3z"}], ")"}], "^", "2"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x2z", "-", "x4z"}], ")"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2x", "-", "x4x"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2y", "-", "x4y"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x2z", "-", "x4z"}], ")"}], "^", "2"}]}], "]"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1xUnit", "=", 
   RowBox[{"r1x", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"r1x", "^", "2"}], "+", 
      RowBox[{"r1y", "^", "2"}], "+", 
      RowBox[{"r1z", "^", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1yUnit", "=", 
   RowBox[{"r1y", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"r1x", "^", "2"}], "+", 
      RowBox[{"r1y", "^", "2"}], "+", 
      RowBox[{"r1z", "^", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r1zUnit", "=", 
    RowBox[{"r1z", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"r1x", "^", "2"}], "+", 
       RowBox[{"r1y", "^", "2"}], "+", 
       RowBox[{"r1z", "^", "2"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3x", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"x1z", "-", "x3z"}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"x2y", "-", "x4y"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x1y", "-", "x3y"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"x2z", "-", "x4z"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3y", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x1z", "-", "x3z"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"x2x", "-", "x4x"}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x1x", "-", "x3x"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"x2z", "-", "x4z"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3z", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"x1y", "-", "x3y"}], ")"}]}], "*", 
     RowBox[{"(", 
      RowBox[{"x2x", "-", "x4x"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x1x", "-", "x3x"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"x2y", "-", "x4y"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5604126085883355`*^9, 3.560412719800931*^9}, {
   3.5604127680674157`*^9, 3.5604127914986567`*^9}, {3.560420113489252*^9, 
   3.5604202151390305`*^9}, {3.560420437127421*^9, 3.5604204579846573`*^9}, {
   3.560421070322994*^9, 3.560421070510195*^9}, {3.5604229411498175`*^9, 
   3.560422960450921*^9}, {3.560423005140477*^9, 3.5604230213804064`*^9}, {
   3.560423080095361*^9, 3.560423118175028*^9}, {3.560423148969482*^9, 
   3.5604233538134418`*^9}, 3.560424108206367*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r3xUnit", " ", "=", " ", 
     RowBox[{"r1x", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"r3x", "^", "2"}], "+", 
        RowBox[{"r3y", "^", "2"}], "+", 
        RowBox[{"r3z", "^", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r3yUnit", " ", "=", " ", 
     RowBox[{"r1y", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"r3x", "^", "2"}], "+", 
        RowBox[{"r3y", "^", "2"}], "+", 
        RowBox[{"r3z", "^", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r3zUnit", " ", "=", " ", 
     RowBox[{"r1z", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"r3x", "^", "2"}], "+", 
        RowBox[{"r3y", "^", "2"}], "+", 
        RowBox[{"r3z", "^", "2"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r2xUnit", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "r3zUnit"}], "*", "r1yUnit"}], "+", 
      RowBox[{"r3zUnit", "*", "r1zUnit"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r2yUnit", " ", "=", " ", 
     RowBox[{
      RowBox[{"r3xUnit", "*", "r1xUnit"}], "-", 
      RowBox[{"r3xUnit", "*", "r1zUnit"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r2zUnit", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "r3zUnit"}], "*", "r1xUnit"}], "+", 
      RowBox[{"r3xUnit", "*", "r1yUnit"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5604233582282495`*^9, 3.560423475119255*^9}, {
  3.5604235403965693`*^9, 3.560423596447468*^9}, {3.560423643621951*^9, 
  3.560423646117955*^9}, {3.5604236801104155`*^9, 3.5604237077068634`*^9}, {
  3.560423767189768*^9, 3.560423964452114*^9}, {3.5604241472064357`*^9, 
  3.5604241478616366`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"{", 
    RowBox[{"r1xUnit", ",", "r1yUnit", ",", "r1zUnit"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{"{", 
    RowBox[{"r2xUnit", ",", "r2yUnit", ",", "r2zUnit"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3", "=", 
   RowBox[{"{", 
    RowBox[{"r3xUnit", ",", "r3yUnit", ",", "r3zUnit"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", "=", 
   RowBox[{"{", 
    RowBox[{"x1x", ",", "x1y", ",", "x1z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2", "=", 
   RowBox[{"{", 
    RowBox[{"x2x", ",", "x2y", ",", "x2z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x3", "=", 
   RowBox[{"{", 
    RowBox[{"x3x", ",", "x3y", ",", "x3z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x4", "=", 
   RowBox[{"{", 
    RowBox[{"x4x", ",", "x4y", ",", "x4z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1xUnit", ",", "r1yUnit", ",", "r1zUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r2xUnit", ",", "r2yUnit", ",", "r2zUnit"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"r3xUnit", ",", "r3yUnit", ",", "r3zUnit"}], "}"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J1", "=", 
   RowBox[{"D", "[", 
    RowBox[{"R", ",", 
     RowBox[{"{", "x1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2", "=", 
   RowBox[{"D", "[", 
    RowBox[{"R", ",", 
     RowBox[{"{", "x2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J3", "=", 
   RowBox[{"D", "[", 
    RowBox[{"R", ",", 
     RowBox[{"{", "x3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J4", "=", 
    RowBox[{"D", "[", 
     RowBox[{"R", ",", 
      RowBox[{"{", "x4", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"D", "[", 
    RowBox[{"R", ",", 
     RowBox[{"{", "x", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.56042348386207*^9, 3.5604234955932913`*^9}, {
   3.5604235339225583`*^9, 3.56042353496776*^9}, {3.560424479849145*^9, 
   3.5604245387745156`*^9}, {3.5604246342169743`*^9, 3.560424656288237*^9}, {
   3.5604247035039377`*^9, 3.560424954983321*^9}, {3.5604250756442227`*^9, 
   3.5604250918701506`*^9}, {3.5604253988907113`*^9, 
   3.5604254477395053`*^9}, {3.560425609402752*^9, 3.560425653306263*^9}, {
   3.560436820846614*^9, 3.560436889611534*^9}, {3.560437057919789*^9, 
   3.5604370752637806`*^9}, {3.5604371170771723`*^9, 3.560437117228181*^9}, 
   3.5604371763225613`*^9, {3.560437236695014*^9, 3.5604372731530995`*^9}, {
   3.5604377849483724`*^9, 3.5604377891186113`*^9}, {3.560437852475235*^9, 
   3.5604378640778985`*^9}, {3.5604383228111362`*^9, 3.560438329356511*^9}, {
   3.5604384231088734`*^9, 3.56043847130763*^9}, {3.5604385482590313`*^9, 
   3.5604385693652387`*^9}, {3.5604907437439117`*^9, 3.560490744896978*^9}, {
   3.560490822136396*^9, 3.560490824283519*^9}}],

Cell[BoxData[""], "Input"],

Cell[BoxData[{
 RowBox[{"<<", "ToMatlab.m"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J1File", "=", 
   RowBox[{"OpenWrite", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<J1File.m\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"J1File", ",", 
    RowBox[{
    "\"\<x1x=xi(1,1); x1y=xi(1,2); x1z=xi(1,3); x2x=xi(2,1);x2y=xi(2,2); \
x2z=xi(2,3);x3x=xi(3,1);x3y=xi(3,2);x3z=xi(3,4);x4x=xi(4,1);x4y=xi(4,2);x4z=\
xi(4,3);\>\"", 
     RowBox[{"ToMatlab", "[", "J1", "]"}]}], ",", "\"\<\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Close", "[", "J1File", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2File", "=", 
   RowBox[{"OpenWrite", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<J2File.m\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"J2File", ",", 
    RowBox[{"ToMatlab", "[", "J2", "]"}], ",", "\"\<\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Close", "[", "J2File", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J3File", "=", 
   RowBox[{"OpenWrite", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<J3File.m\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"J3File", ",", 
    RowBox[{"ToMatlab", "[", "J3", "]"}], ",", "\"\<\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Close", "[", "J3File", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J4File", "=", 
   RowBox[{"OpenWrite", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<J4File.m\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"J4File", ",", 
    RowBox[{"ToMatlab", "[", "J4", "]"}], ",", "\"\<\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Close", "[", "J4File", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JFile", "=", 
   RowBox[{"OpenWrite", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<JFile.m\>\""}], 
      "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "JFile", ",", 
    "\"\<x1x=xi(1,1); x1y=xi(1,2); x1z=xi(1,3); x2x=xi(2,1);x2y=xi(2,2); \
x2z=xi(2,3);x3x=xi(3,1);x3y=xi(3,2);x3z=xi(3,4);x4x=xi(4,1);x4y=xi(4,2);x4z=\
xi(4,3);\>\"", ",", 
    RowBox[{"ToMatlab", "[", "J", "]"}], ",", "\"\<\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "JFile", "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5604384857894583`*^9, 3.560438519625394*^9}, 
   3.5604390047128105`*^9, {3.560439048080887*^9, 3.5604391052725873`*^9}, {
   3.560449107832271*^9, 3.5604491822965307`*^9}, 3.5604492294532275`*^9, {
   3.560449409941551*^9, 3.56044957146379*^9}, {3.560449663971081*^9, 
   3.5604497372752733`*^9}, {3.5604507324423356`*^9, 3.560450798633252*^9}, {
   3.560489929025313*^9, 3.560489944133177*^9}, {3.5604907577657137`*^9, 
   3.5604907591567936`*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.5604383180828657`*^9}]
},
WindowSize->{1264, 665},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 5417, 171, 232, "Input"],
Cell[5977, 193, 1862, 49, 172, "Input"],
Cell[7842, 244, 3362, 93, 332, "Input"],
Cell[11207, 339, 26, 0, 31, "Input"],
Cell[11236, 341, 3698, 100, 512, "Input"],
Cell[14937, 443, 89, 1, 52, "Input"]
}
]
*)

(* End of internal cache information *)
