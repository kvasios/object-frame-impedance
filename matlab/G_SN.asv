function Gsn=G_SN(ni_ri)

ni=ni_ri(1:12);
ri=ni_ri(13:24);

n1=ni(1:3);
n2=ni(4:6);
n3=ni(7:9);
n4=ni(10:12);

r1=ri(1:3);
r2=ri(4:6);
r3=ri(7:9);
r4=ri(10:12);

G=[n1' n2' n3' n4' ;skew(r1)*n1 skew(r2)*n2 skew(r3)*n3 skew(r4)*n4];

G_pinv=pinv(G);

Gsn=eye(1,12)-G_pinv*G;