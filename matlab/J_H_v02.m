function JH=J_H_v02(q)

J=zeros(12,16);

L2 = 1.10;
L3 = 0.60;
L4 = 0.55;

rot_base=[0.0000         0   -1.0000;
         0    1.0000         0;
    1.0000         0    0.0000];

c=1;
for i=1:4:16
q1 = q(i);
q2 = q(i+1);
q3 = q(i+2);
q4 = q(i+3);
    
    
J(c:c+2,i:i+3)=rot_base*[(-1) .* (L2 .* cos(q2) + L3 .* cos(q2 + q3) + L4 .* cos(q2 + q3 + ...
   q4)) .* sin(q1),(-1) .* cos(q1) .* (L2 .* sin(q2) + L3 .* sin(q2  ...
  + q3) + L4 .* sin(q2 + q3 + q4)),(-1) .* cos(q1) .* (L3 .* sin(q2  ...
  + q3) + L4 .* sin(q2 + q3 + q4)),(-1) .* L4 .* cos(q1) .* sin(q2 + ...
   q3 + q4);cos(q1) .* (L2 .* cos(q2) + L3 .* cos(q2 + q3) + L4 .*  ...
  cos(q2 + q3 + q4)),(-1) .* sin(q1) .* (L2 .* sin(q2) + L3 .* sin( ...
  q2 + q3) + L4 .* sin(q2 + q3 + q4)),(-1) .* sin(q1) .* (L3 .* sin( ...
  q2 + q3) + L4 .* sin(q2 + q3 + q4)),(-1) .* L4 .* sin(q1) .* sin( ...
  q2 + q3 + q4);0,cos(q1) .^ 2 .* (L2 .* cos(q2) + L3 .* cos(q2 +  ...
  q3) + L4 .* cos(q2 + q3 + q4)) + (L2 .* cos(q2) + L3 .* cos(q2 +  ...
  q3) + L4 .* cos(q2 + q3 + q4)) .* sin(q1) .^ 2,cos(q1) .* ((-1) .* ...
   L2 .* cos(q1) .* cos(q2) + cos(q1) .* (L2 .* cos(q2) + L3 .* cos( ...
  q2 + q3) + L4 .* cos(q2 + q3 + q4))) + sin(q1) .* ((-1) .* L2 .*  ...
  cos(q2) .* sin(q1) + (L2 .* cos(q2) + L3 .* cos(q2 + q3) + L4 .*  ...
  cos(q2 + q3 + q4)) .* sin(q1)),cos(q1) .* ((-1) .* cos(q1) .* (L2  ...
  .* cos(q2) + L3 .* cos(q2 + q3)) + cos(q1) .* (L2 .* cos(q2) + L3  ...
  .* cos(q2 + q3) + L4 .* cos(q2 + q3 + q4))) + sin(q1) .* ((-1) .*  ...
  (L2 .* cos(q2) + L3 .* cos(q2 + q3)) .* sin(q1) + (L2 .* cos(q2) + ...
   L3 .* cos(q2 + q3) + L4 .* cos(q2 + q3 + q4)) .* sin(q1))];

c=c+3;
end

JH=J;